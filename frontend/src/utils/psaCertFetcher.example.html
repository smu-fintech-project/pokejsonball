<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PSA Certificate Fetcher - Usage Example</title>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      max-width: 800px;
      margin: 40px auto;
      padding: 20px;
      background: #f5f5f5;
    }
    
    h1 {
      color: #1a1a2e;
      margin-bottom: 8px;
    }
    
    .description {
      color: #666;
      margin-bottom: 32px;
    }
    
    .input-group {
      background: white;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    label {
      display: block;
      font-weight: 600;
      margin-bottom: 8px;
      color: #333;
    }
    
    input {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
      box-sizing: border-box;
    }
    
    input:focus {
      outline: none;
      border-color: #4f46e5;
      box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
    }
    
    button {
      background: #4f46e5;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s;
    }
    
    button:hover {
      background: #4338ca;
    }
    
    button:disabled {
      background: #9ca3af;
      cursor: not-allowed;
    }
    
    #result {
      min-height: 100px;
    }
    
    .loading {
      text-align: center;
      padding: 40px;
      color: #666;
    }
    
    .code-example {
      background: #1e1e1e;
      color: #d4d4d4;
      padding: 20px;
      border-radius: 8px;
      overflow-x: auto;
      margin-top: 32px;
    }
    
    .code-example pre {
      margin: 0;
      font-family: 'Monaco', 'Menlo', 'Courier New', monospace;
      font-size: 13px;
      line-height: 1.6;
    }
  </style>
</head>
<body>
  <h1>PSA Certificate Fetcher</h1>
  <p class="description">
    Fetch and render PSA certificate metadata dynamically - no hardcoded values!
  </p>

  <div class="input-group">
    <label for="certNumber">PSA Certificate Number</label>
    <input 
      type="text" 
      id="certNumber" 
      placeholder="e.g., 116230496" 
      value="116230496"
    >
  </div>

  <div class="input-group">
    <label for="apiToken">PSA API Token</label>
    <input 
      type="password" 
      id="apiToken" 
      placeholder="Your PSA API Bearer Token"
    >
  </div>

  <button id="fetchBtn">Fetch Certificate Data</button>

  <div id="result"></div>

  <div class="code-example">
    <pre><code>// Usage Example

import { fetchAndRenderCert } from './psaCertFetcher.js';

// Get DOM elements
const container = document.getElementById('cert-metadata');
const PSA_TOKEN = 'your-api-token-here';

// Fetch and render certificate
const result = await fetchAndRenderCert(
  'https://api.psacard.com/publicapi/v1/cert/12345678',
  PSA_TOKEN,
  container
);

if (result.success) {
  console.log('Certificate data:', result.fields);
  // { name: "Charizard", grade: "GEM MT 10", year: 1999 }
} else {
  console.error('Failed:', result.error);
}

// Batch fetch multiple certificates
import { batchFetchCerts } from './psaCertFetcher.js';

const certs = await batchFetchCerts([
  { metaUrl: 'https://api.psacard.com/publicapi/v1/cert/12345678' },
  { metaUrl: 'https://api.psacard.com/publicapi/v1/cert/87654321' },
], PSA_TOKEN);

console.log(certs);
// [
//   { certNumber: '12345678', success: true, data: {...} },
//   { certNumber: '87654321', success: true, data: {...} }
// ]</code></pre>
  </div>

  <script type="module">
    import { fetchAndRenderCert } from './psaCertFetcher.js';

    const fetchBtn = document.getElementById('fetchBtn');
    const result = document.getElementById('result');
    const certNumberInput = document.getElementById('certNumber');
    const apiTokenInput = document.getElementById('apiToken');

    fetchBtn.addEventListener('click', async () => {
      const certNumber = certNumberInput.value.trim();
      const token = apiTokenInput.value.trim();

      if (!certNumber) {
        alert('Please enter a certificate number');
        return;
      }

      if (!token) {
        alert('Please enter your PSA API token');
        return;
      }

      // Show loading state
      fetchBtn.disabled = true;
      fetchBtn.textContent = 'Fetching...';
      result.innerHTML = '<div class="loading">Fetching certificate data...</div>';

      try {
        // Construct PSA API URL
        const metaUrl = `https://api.psacard.com/publicapi/v1/cert/GetByCertNumber/${certNumber}`;

        // Fetch and render
        const data = await fetchAndRenderCert(metaUrl, token, result);

        console.log('Result:', data);
      } catch (error) {
        console.error('Error:', error);
      } finally {
        fetchBtn.disabled = false;
        fetchBtn.textContent = 'Fetch Certificate Data';
      }
    });
  </script>
</body>
</html>

